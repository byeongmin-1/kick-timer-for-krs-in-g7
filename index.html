<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Persistent Timer App</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #f4f4f4; }
  </style>
</head>
<body>
  <h1>Timer App</h1>
  <label>Name: <input id="nameInput" type="text"></label>
  <label>Duration (seconds): <input id="durationInput" type="number"></label>
  <button onclick="addTimer()">Add Timer</button>

  <h2>Active Timers</h2>
  <table id="activeTable">
    <tr><th>Name</th><th>Time Left</th></tr>
  </table>

  <h2>Finished Timers</h2>
  <table id="finishedTable">
    <tr><th>Name</th><th>Status</th></tr>
  </table>

  <script>
    let timers = [];

    function saveTimers() {
      localStorage.setItem("timers", JSON.stringify(timers));
    }

    function loadTimers() {
      const saved = JSON.parse(localStorage.getItem("timers") || "[]");
      const now = Date.now();
      timers = saved.map(t => {
        let remaining = t.endTime - now;
        return {
          name: t.name,
          endTime: t.endTime,
          finished: remaining <= 0
        };
      });
    }

    function addTimer() {
      const name = document.getElementById("nameInput").value.trim();
      const duration = parseInt(document.getElementById("durationInput").value);
      if (!name || isNaN(duration) || duration <= 0) return;

      const endTime = Date.now() + duration * 1000;
      timers.push({ name, endTime, finished: false });
      saveTimers();
      render();
    }

    function formatTime(ms) {
      if (ms <= 0) return "00:00:00";
      let totalSeconds = Math.floor(ms / 1000);
      let h = Math.floor(totalSeconds / 3600);
      let m = Math.floor((totalSeconds % 3600) / 60);
      let s = totalSeconds % 60;
      return [h, m, s].map(x => String(x).padStart(2, '0')).join(":");
    }

    function render() {
      const now = Date.now();
      const activeTable = document.getElementById("activeTable");
      const finishedTable = document.getElementById("finishedTable");

      activeTable.innerHTML = "<tr><th>Name</th><th>Time Left</th></tr>";
      finishedTable.innerHTML = "<tr><th>Name</th><th>Status</th></tr>";

      timers.forEach(t => {
        let remaining = t.endTime - now;
        if (remaining > 0 && !t.finished) {
          const row = activeTable.insertRow();
          row.insertCell().innerText = t.name;
          row.insertCell().innerText = formatTime(remaining);
        } else {
          t.finished = true;
          const row = finishedTable.insertRow();
          row.insertCell().innerText = t.name;
          row.insertCell().innerText = "Finished";
        }
      });
      saveTimers();
    }

    setInterval(render, 1000);

    loadTimers();
    render();
  </script>
</body>
</html>
