<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Timer App</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #timers, #finished { margin-top: 20px; }
    .timer { margin: 5px 0; }
    button { margin-left: 10px; }
  </style>
</head>
<body>
  <h1>Timer App</h1>

  <div>
    <input id="timerName" placeholder="Timer name"/>
    <input id="hours" type="number" min="0" placeholder="Hours"/>
    <input id="minutes" type="number" min="0" max="59" placeholder="Minutes"/>
    <input id="seconds" type="number" min="0" max="59" placeholder="Seconds"/>
    <button onclick="addTimer()">Add Timer</button>
    <button onclick="resetAll()">Reset All</button>
  </div>

  <h2>Active Timers</h2>
  <div id="timers"></div>

  <h2>Finished Timers</h2>
  <div id="finished"></div>

  <script>
    let timers = JSON.parse(localStorage.getItem("timers")) || [];
    let finishedTimers = JSON.parse(localStorage.getItem("finishedTimers")) || [];

    function saveData() {
      localStorage.setItem("timers", JSON.stringify(timers));
      localStorage.setItem("finishedTimers", JSON.stringify(finishedTimers));
    }

    function renderTimers() {
      const timersDiv = document.getElementById("timers");
      const finishedDiv = document.getElementById("finished");
      timersDiv.innerHTML = "";
      finishedDiv.innerHTML = "";

      timers.forEach((t, i) => {
        const div = document.createElement("div");
        div.className = "timer";
        div.textContent = `${t.name} - ${t.hours}h ${t.minutes}m ${t.seconds}s`;
        timersDiv.appendChild(div);
      });

      finishedTimers.forEach((t, i) => {
        const div = document.createElement("div");
        div.className = "timer";
        div.textContent = `${t.name} (Finished)`;
        finishedDiv.appendChild(div);
      });
    }

    function addTimer() {
      const name = document.getElementById("timerName").value || "Unnamed";
      const hours = parseInt(document.getElementById("hours").value) || 0;
      const minutes = parseInt(document.getElementById("minutes").value) || 0;
      const seconds = parseInt(document.getElementById("seconds").value) || 0;

      timers.push({ name, hours, minutes, seconds });
      saveData();
      renderTimers();
    }

    function resetAll() {
      let message = `üîÑ Reset pressed at: ${new Date().toLocaleString()}\n\n`;

      message += "Active Timers:\n";
      if (timers.length === 0) {
        message += "None\n";
      } else {
        timers.forEach(t => {
          message += `${t.name} | ${t.hours}h ${t.minutes}m ${t.seconds}s\n`;
        });
      }

      message += "\nFinished Timers:\n";
      if (finishedTimers.length === 0) {
        message += "None\n";
      } else {
        finishedTimers.forEach(t => {
          message += `${t.name} | ${t.hours}h ${t.minutes}m ${t.seconds}s\n`;
        });
      }

      let formData = new FormData();
      formData.append("email", "byeongminchoi12@gmail.com");
      formData.append("message", message);

      fetch("https://formspree.io/f/mqadbkbd", {
        method: "POST",
        body: formData,
        headers: { 'Accept': 'application/json' }
      })
      .then(response => {
        if (response.ok) {
          alert("‚úÖ Reset info sent to Formspree!");
        } else {
          alert("‚ö†Ô∏è Failed to send reset info.");
        }
      })
      .catch(() => alert("‚ö†Ô∏è Error sending reset info."));

      // Clear data
      localStorage.removeItem("timers");
      localStorage.removeItem("finishedTimers");
      timers = [];
      finishedTimers = [];
      renderTimers();
    }

    renderTimers();
  </script>
</body>
</html>
